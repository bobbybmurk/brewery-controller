<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brewery Controller</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header>
            <h1>üç∫ Brewery Controller</h1>
            <div class="status-badge" id="mode-badge">Loading...</div>
        </header>

        <!-- Temperature Monitoring Section -->
        <section class="monitoring-section">
            <h2>Temperature Monitoring</h2>
            
            <div class="vessel-grid">
                <!-- HLT (Hot Liquor Tank) -->
                <div class="vessel-card">
                    <div class="vessel-header">
                        <h3>Hot Liquor Tank (HLT)</h3>
                        <span class="sensor-address">Sensor: 0x76</span>
                    </div>
                    <div class="temp-display">
                        <span class="temp-value" id="hlt-temp">--</span>
                        <span class="temp-unit">¬∞F</span>
                    </div>
                    <div class="vessel-details">
                        <div class="detail-item">
                            <span class="detail-label">Humidity:</span>
                            <span class="detail-value" id="hlt-humidity">--</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Pressure:</span>
                            <span class="detail-value" id="hlt-pressure">--</span>
                        </div>
                    </div>
                    <div class="setpoint-control">
                        <label>Target Temp:</label>
                        <input type="number" id="hlt-setpoint" value="170" step="1" min="32" max="212">
                        <span>¬∞F</span>
                        <button class="setpoint-btn" data-vessel="hlt">Set</button>
                    </div>
                    <div class="auto-mode-control">
                        <button class="auto-btn" data-vessel="hlt" data-mode="off">
                            <span class="auto-label">AUTO MODE: OFF</span>
                        </button>
                    </div>
                </div>

                <!-- Mash Tun -->
                <div class="vessel-card">
                    <div class="vessel-header">
                        <h3>Mash Tun</h3>
                        <span class="sensor-address">Sensor: 0x77</span>
                    </div>
                    <div class="temp-display">
                        <span class="temp-value" id="mash-temp">--</span>
                        <span class="temp-unit">¬∞F</span>
                    </div>
                    <div class="vessel-details">
                        <div class="detail-item">
                            <span class="detail-label">Humidity:</span>
                            <span class="detail-value" id="mash-humidity">--</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Pressure:</span>
                            <span class="detail-value" id="mash-pressure">--</span>
                        </div>
                    </div>
                    <div class="setpoint-control">
                        <label>Target Temp:</label>
                        <input type="number" id="mash-setpoint" value="152" step="1" min="32" max="212">
                        <span>¬∞F</span>
                        <button class="setpoint-btn" data-vessel="mash">Set</button>
                    </div>
                    <div class="auto-mode-control">
                        <button class="auto-btn" data-vessel="mash" data-mode="off">
                            <span class="auto-label">AUTO MODE: OFF</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Equipment Control Section -->
        <section class="control-section">
            <h2>Equipment Control</h2>
            
            <div class="control-grid">
                <!-- Heaters -->
                <div class="control-group">
                    <h3>Heaters</h3>
                    <div class="control-item">
                        <span class="control-label">HLT Heater (240V)</span>
                        <button class="relay-btn" data-relay="heater_1" data-state="off">
                            <span class="btn-label">OFF</span>
                        </button>
                    </div>
                    <div class="control-item">
                        <span class="control-label">Mash Heater (240V)</span>
                        <button class="relay-btn" data-relay="heater_2" data-state="off">
                            <span class="btn-label">OFF</span>
                        </button>
                    </div>
                    <div class="warning-note">
                        ‚ö†Ô∏è Testing with relay board. Will use SSRs for production.
                    </div>
                </div>

                <!-- Pumps -->
                <div class="control-group">
                    <h3>Transfer Pumps</h3>
                    <div class="control-item">
                        <span class="control-label">HLT ‚Üí Mash Pump</span>
                        <button class="relay-btn" data-relay="pump_1" data-state="off">
                            <span class="btn-label">OFF</span>
                        </button>
                    </div>
                    <div class="control-item">
                        <span class="control-label">Mash ‚Üí Boil Pump</span>
                        <button class="relay-btn" data-relay="pump_2" data-state="off">
                            <span class="btn-label">OFF</span>
                        </button>
                    </div>
                </div>

                <!-- Spare Channels -->
                <div class="control-group">
                    <h3>Spare Channels</h3>
                    <div class="control-item">
                        <span class="control-label">Spare 1</span>
                        <button class="relay-btn" data-relay="spare_1" data-state="off">
                            <span class="btn-label">OFF</span>
                        </button>
                    </div>
                    <div class="control-item">
                        <span class="control-label">Spare 2</span>
                        <button class="relay-btn" data-relay="spare_2" data-state="off">
                            <span class="btn-label">OFF</span>
                        </button>
                    </div>
                    <div class="control-item">
                        <span class="control-label">Spare 3</span>
                        <button class="relay-btn" data-relay="spare_3" data-state="off">
                            <span class="btn-label">OFF</span>
                        </button>
                    </div>
                    <div class="control-item">
                        <span class="control-label">Spare 4</span>
                        <button class="relay-btn" data-relay="spare_4" data-state="off">
                            <span class="btn-label">OFF</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Emergency Stop -->
            <div class="emergency-section">
                <button class="emergency-btn" id="emergency-stop">
                    üõë EMERGENCY STOP - ALL OFF
                </button>
            </div>
        </section>

        <!-- Status Bar -->
        <footer>
            <div class="status-bar">
                <span id="last-update">Last update: Never</span>
                <span id="connection-status" class="connection-ok">‚óè Connected</span>
            </div>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
